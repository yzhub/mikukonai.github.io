#!title:    傅里叶变换
#!date:     2020-02-06
#!authors:  Mikukonai
#!cover:    ./image/wiki/M/waveform.jpg
#!type:     原创
#!tags:     M,信号与系统

#!content

# 0 绪言

啊，美妙的傅里叶变换，我歌颂你，我赞美你。

本文的目的是梳理傅里叶变换的来龙去脉，欣赏傅里叶变换在众多的实际问题中美妙的应用。

# 1 基本信号

## 1.1 单位冲激函数

单位冲激函数$ \delta (t)$，又叫狄拉克函数，其值仅在0时刻为非0，其余时刻均为0；可以定义为能量为1的极短脉冲，即

$$ \int _{- \infty} ^{ + \infty} \delta (t) dt = 1$$

它的主要性质有：

- 筛选性质：$ f(t) \delta (t - k) = f(k) \delta (t - k)$
- 采样性质：$ \int  _{- \infty} ^{ + \infty} f(t) \delta (t-k) dt = f(k)$
- 坐标变换：$ \delta (at) = \frac{1}{|a|} \delta (t)$

其一阶导数是一对冲激，称为“冲激偶”。

## 1.2 复指数信号

复指数信号是周期信号：

$$ x(t) = \mathrm{e} ^{ \mathrm{j} \omega_0 t} $$

其基波频率为$ \omega_0$，周期为$2\pi / \omega_0$。

# 2 线性时不变系统

线性系统，指的是满足叠加性质的系统。即，如果输入信号是若干个基本信号的线性组合，将其输入线性系统后的输出，等于这些基本信号分别输入该线性系统后得到的输出信号的线性组合。记基本信号为$s_1$和$s_2$，线性系统对输入信号s的响应为$T(s)$，则线性系统满足：

$$ T(as_1 + bs_2) = aT(s_1) + bT(s2) $$

时不变系统，指满足$ T(s(t)) = T(s(t-t_0))$的系统，这意味着时不变系统对于时移信号的响应与输入信号的时移是一致的，进一步地说，时不变系统本身是不随时间变化的。作为对比，时间压缩系统$y(t) = x(2t)$是一个典型的时变系统，因为它压缩了时间的尺度，使得该系统对时移信号的响应信号的时移，仅有输入信号的一半。

线性和时不变性是两个独立的性质。同时具有线性和时不变性质的系统，称为**线性时不变（Linear Time-Invariant，LTI）系统**。

# 3 卷积运算

## 3.1 离散信号的脉冲表示

首先考虑一个问题：如何使用一组不同时移的单位脉冲序列的线性组合，来表示任意的离散信号（序列）x[n]。

这个问题在直观上很容易理解：离散序列的每个点，都是移位并加权了的单位脉冲序列（在移位位置上的值）。那么显然，将所有这些移位加权的序列加总起来，就得到了原始的离散序列。根据单位脉冲序列的性质也可以知道：

$$ x[n] = \sum _{k = - \infty} ^{ + \infty} x[k] \delta [n - k]$$

这与直观理解是一致的，即离散序列可以视为k移位加权的单位脉冲序列的加总，权重即为序列在相应移位位置k上的值x[k]。

## 3.2 LTI系统对离散序列的响应

**① 考虑线性系统对离散序列的响应。**

由于离散序列可以表示为一组不同时移的单位脉冲的线性组合，所以线性系统对离散序列的响应，就等于线性系统对于每个时移单位脉冲的响应的线性组合。

记线性系统对时移单位脉冲的响应为$h_k[n]$，其中k为时移量。线性系统未必是时不变的，因此$h_k[n]$可能与k有关。

因此，线性系统对于离散序列$x[n]$的响应$y[n]$就是

$$ y[n] = \sum _{k = - \infty} ^{ + \infty} x[k] h_k[n] $$

**② 如果线性系统也是时不变系统呢？**

既然是时不变系统，那么$h_k[n]$就等于$h_0[n - k]$，其中$h_0[n]$就是这个线性时不变系统对于（无时移）单位脉冲序列的响应，称为系统的**单位脉冲响应**。简单起见，将$h_0[n]$直接写成$h[n]$，这样的话，线性时不变系统对于离散序列的响应，就可以写成是

$$ y[n] = \sum _{k = - \infty} ^{ + \infty} x[k] h[n - k] \tag{3-1}$$

上式（3-1）定义为x[n]与h[n]的**卷积**（和）运算，记为

$$ y[n] = x[n] * h[n] $$

于是可以说：**LTI系统对于离散序列的响应，等于输入序列与系统单位脉冲响应的卷积。**

## 3.3 连续信号的冲激表示

这一节要解决的问题与3.1节的问题是类似的：如何用一组不同时移的单位冲激信号的线性组合，来表示任意的连续信号x(t)。

直观上的理解与离散序列的情况是类似的，不同的是需要使用极短间隔Δ→0的极限去代替离散序列的加总。这种情况下，加总就变成了积分，但思想是一致的。根据单位冲激函数的性质可知

$$ x(t) = \int  _{- \infty} ^{ + \infty} x( \tau ) \delta (t - \tau) d \tau $$

与离散情况类似，连续信号可以表示为加权的单位冲激函数在所有位移τ上的积分，权重即为原信号在相应位移τ上的值x(τ)。

## 3.4 LTI系统对连续信号的响应

与3.2节的分析类似，这里不再详细讨论，直接给出结论。

设h(t)为LTI系统的**单位冲激响应**，则LTI系统对连续信号x(t)的响应y(t)为

$$ y(t) = \int  _{- \infty} ^{ + \infty} x( \tau ) h (t - \tau) d \tau  \tag{3-2}$$

式（3-2）定义为x(t)与h(t)的**卷积**（积分）运算，记为

$$ y(t) = x(t) * h(t) $$

因此可以说，**LTI系统对于连续信号的响应，等于输入信号与系统单位冲激响应的卷积。**

## 3.5 卷积运算的性质

- 交换律
- 分配律
- 结合律

这三个性质也对应了LTI系统各个子系统之间级联和并联的关系。

# 4 周期信号的傅里叶级数展开

![方波信号的4次谐波展开](./image/wiki/M/fourier-series-deferent-epicycle.gif)

## 4.1 连续信号

**① 将周期信号表示成谐波的线性组合**

给出一个基频为$ \omega_0$的复指数信号$ \mathrm{e} ^{ \mathrm{j} \omega_0 t} $，这是一个周期信号。

再给出一族信号$ \mathrm{e} ^{ \mathrm{j} k \omega_0 t} $，其中k=0，±1，±2…，其中的每个信号都有一个基频$ k \omega_0$，是$ \omega_0$的倍数，因此每个信号都是以$ \omega_0$为频率的周期信号。这些信号称为与$ \mathrm{e} ^{ \mathrm{j} \omega_0 t} $成谐波关系。

于是，由一族成谐波关系的信号线性组合而得的信号

$$ x(n) = \sum _{k = - \infty} ^{ + \infty} a_k \mathrm{e} ^{ \mathrm{j} k \omega_0 t} \tag{4-1}$$

也是以$ \omega_0$为频率的周期信号。

式（4-1）称为周期信号x(t)的傅里叶级数表示。

**② 确定各个谐波成分的系数a_k**

对式（4-1）两侧同乘$ \mathrm{e} ^{ \mathrm{j} n \omega_0 t} $，并将其两侧在一个周期T内积分，得到

$$ \int _{0} ^{T} x(t) \mathrm{e} ^{ - \mathrm{j} n \omega_0 t} dt = \int _{0} ^{T} ( \sum _{k = - \infty} ^{ + \infty} a_k \mathrm{e} ^{ \mathrm{j} k \omega_0 t} \mathrm{e} ^{ - \mathrm{j} n \omega_0 t} ) dt $$

交换右侧的积分和求和的顺序，得到

$$ \int _{0} ^{T} x(t) \mathrm{e} ^{ - \mathrm{j} n \omega_0 t} dt = \sum _{k = - \infty} ^{ + \infty} a_k ( \int _{0} ^{T} \mathrm{e} ^{ \mathrm{j} (k-n) \omega_0 t} dt ) $$

右边的积分是在一个周期内进行的，若n=k，则积分值为T；若n≠k，则积分值为0。因此，右边和式里面的项仅在n=k时取得$Ta_n$的值，其余n≠k时均为0，因此右侧和式的值为$Ta_n$。

整理上式，将$a_n$留在一侧，得到

$$ a_n = \frac {1}{T} \int _{0} ^{T} x(t) \mathrm{e} ^{ - \mathrm{j} n \omega_0 t} dt $$

注意到只要是在一个周期内积分，结果就与积分的起点和终点无关，因此可以写成在任意的整周期内积分：

$$ a_n = \frac {1}{T} \int _{T} x(t) \mathrm{e} ^{ - \mathrm{j} n \omega_0 t} dt $$

以上的推导过程可以理解成是用一个n次谐波的“基底”对原始信号作“匹配”，由于不同次数的基底是正交的，因此不同次数的正交基之间相互作用会得到0而被过滤掉，只有第n次的谐波成分被“匹配”出来，从而计算出相应次数的谐波的系数。

![三角正交基。图源：维基百科词条“傅里叶级数”](./image/wiki/M/fourier-triangle-basis.gif)

基于这种理解，上式的n可以改写成k。因此，式（4-1）中的系数$a_k$可以由下式计算：

$$ a_k = \frac {1}{T} \int _{T} x(t) \mathrm{e} ^{ - \mathrm{j} k \omega_0 t} dt \tag{4-2}$$

式（4-1）（4-2）即为连续周期信号的傅里叶级数展开。

可见，**周期信号的频谱是离散的**。

**③ 傅里叶级数的收敛条件：狄利克雷条件**

周期信号能够表示成傅里叶级数（4-1）是有条件的。目前并没有找到充要条件，但是有一个能够满足绝大多数实际信号的充分（不必要）条件：

+ 信号在每个周期内，都必须绝对可积。
+ 信号在每个周期内，都只有有限个极大值或极小值。
+ 信号在任何有限区间内，都只有有限个间断点，且间断点处的函数值为有限值（即第一类间断点）。

这就是**狄利克雷（Dirichlet）条件**。

## 4.2 离散信号

离散信号的傅里叶级数在思路上与连续信号是类似的，但是有一点不同：离散周期信号的傅里叶级数是有限项级数，因此不存在收敛性的问题。

首先考虑周期为N的谐波信号族$ \phi _k [n] = \mathrm{e} ^{\mathrm{j} k (2 \pi / N) n} $的性质。在连续信号的情形下，每个k次谐波都是不同的。但是在离散信号的情形下，实际上只有N个各不相同的谐波信号。这是因为$ \phi _k [n] = \phi _{k + rN} [n] $。

这样一来，只需要N个相继的谐波信号，就可以表示出一个周期为N的离散周期信号。

周期为N的离散周期信号x[n]的傅里叶级数及级数系数为：

$$ x[n] = \sum _{k = \langle N \rangle} a_k \mathrm{e} ^{ \mathrm{j} k (2 \pi / N) n} \tag{4-3} $$

$$ a_k = \frac{1}{N} \sum _{k = \langle N \rangle} x[n] \mathrm{e} ^{- \mathrm{j} k (2 \pi / N) n} \tag{4-4} $$

# 5 傅里叶变换

## 5.1 连续时间傅里叶变换

本节讨论的是如何将连续的非周期信号表示成复指数信号的组合的形式。根据上一章有关傅里叶级数的知识，可以作以下的推论：

+ 周期信号的周期越长，意味着基波频率越小，其（离散的）谐波成分之间的频率间隔就越小。
+ 非周期信号可以看成是周期无限长的周期信号。
+ 因此可以推论，非周期信号的“谐波成分”之间的间隔是趋于0的。此时，谐波成分的组合方式，体现为积分，而不是加和。
+ 进而，**非周期信号的频率谱是连续的。**

以下简要记录连续时间傅里叶变换对的推导过程。

**① 延拓信号的傅里叶级数**

考虑一个时间有限的连续非周期信号x(t)。将其以周期T重复并延拓，得到延拓后的周期信号$\tilde x(t)$。延拓信号可以表示成傅里叶级数的形式，并且取一个周期为[-T/2, T/2]：

$$ \tilde x(t) = \sum _{k = - \infty} ^{ + \infty} a_k \mathrm{e} ^{ \mathrm{j} k \omega_0 t} \tag{5-1}$$

$$ a_k = \frac {1}{T} \int _{-T/2} ^{T/2} \tilde x(t) \mathrm{e} ^{ - \mathrm{j} k \omega_0 t} dt \tag{5-2}$$

尝试将（5-2）中的$\tilde x(t)$换成x(t)，因为在[-T/2, T/2]内$ \tilde x(t) = x(t) $，除此之外x(t) = 0，因此可以将$\tilde x(t)$换成x(t)，同时将积分限换成正负无穷：

$$ a_k = \frac {1}{T} \int _{- \infty} ^{+ \infty} x(t) \mathrm{e} ^{ - \mathrm{j} k \omega_0 t} dt \tag{5-3}$$

**② 系数的与延拓周期无关的包络函数**

式（5-3）中，$Ta_k$可以看成是包络函数

$$ X( \mathrm{j} ω) = \int _{- \infty} ^{+ \infty} x(t) \mathrm{e} ^{ - \mathrm{j} ω t} dt \tag{5-4} $$

在$ω = kω_0$处的采样。

可见，这个包络函数$X( \mathrm{j} ω)$与延拓周期并没有关系，仅由原来的非周期函数决定。将系数$a_k$用包络函数来表示即为

$$ a_k = \frac{1}{T} X(\mathrm{j} k ω_0)$$

到这里，延拓信号的傅里叶级数（5-1）就可以用包络函数（5-4）表示成（注意$ T = 2 \pi / ω_0 $）

$$ \tilde x(t) = \frac{1}{2 \pi} \sum _{k = - \infty} ^{ + \infty} ω_0 X(\mathrm{j} k ω_0) \mathrm{e} ^{ \mathrm{j} k \omega_0 t} \tag{5-5} $$

**③ 将延拓函数的傅里叶级数推广到原始的非周期信号**

若T→∞（$ω_0$→0），则延拓信号$\tilde x(t)$就变成了原来的非周期信号x(t)，式（5-5）从求和变成积分：

$$ x(t) = \frac{1}{2 \pi} \int _{- \infty} ^{+ \infty} X(\mathrm{j} ω) \mathrm{e} ^{ \mathrm{j} ω t} dω \tag{5-6} $$

式（5-4）为**傅里叶变换**，式（5-6）为**傅里叶逆变换**。

式（5-6）的自变量之所以是$\mathrm{j} ω$，是为了兼容拉普拉斯变换。

**④ 傅里叶变换的收敛条件：狄利克雷条件**

与连续周期信号的傅里叶级数类似，连续非周期函数的傅里叶变换也有一个充分条件，即狄利克雷条件：

+ 原信号绝对可积。
+ 在任何有限区间内，原信号只有有限个极值。
+ 在任何有限区间内，原信号只有有限和第一类间断点。

**⑤ 周期信号的傅里叶变换**

上面介绍的都是在有限时间内、绝对可积的、连续的、非周期信号的傅里叶变换，那么这一节讨论的是无限长的、周期信号的傅里叶变换，这样就可以将非周期信号和无限长周期信号的傅里叶变换纳入到一个统一的框架中。

周期信号的傅里叶级数系数是离散的若干个值，代表各个谐波成分的强度。那么在连续谱的情形下，就可以推广为一族冲激信号的组合，每个冲激的强度由傅里叶级数的系数确定。

例如，频率为$ω_0$的复指数信号$ \mathrm{e} ^{ \mathrm{j} ω_0 t} $，其傅里叶变换$X( \mathrm{j} ω)$为

$$ X( \mathrm{j} ω) = 2 \pi \delta (ω - ω_0) $$

## 5.2 离散时间傅里叶变换

离散时间傅里叶变换的推导思路与连续时间情形的思路是类似的，即从非周期序列的延拓序列的傅里叶级数出发，推广到非周期序列的傅里叶变换，进而推广到周期序列的傅里叶变换。以下直接给出**离散时间傅里叶变换（DTFT）**的公式：

$$ x[n] = \frac{1}{2 \pi} \int _{2 \pi} X(\mathrm{e} ^{ \mathrm{j} ω}) \mathrm{e} ^{ \mathrm{j} ω n} dω \tag{5-7} $$

$$ X(\mathrm{e} ^{ \mathrm{j} ω}) = \sum _{n = - \infty} ^{ + \infty} x[n] \mathrm{e} ^{- \mathrm{j}  ω n}  \tag{5-8} $$

由于频率相差2π的谐波信号是完全相同的，因此式（5-7）的积分限是任何长度为2π的区间，这也导致**离散序列的频谱是周期的**。该式实际上就是非周期信号x[n]的谐波组合表示，只不过由于x[n]是非周期的，组成它的谐波成分的基波频率趋于0，因此每个谐波成分之间的间距也趋于0，其频谱$X(\mathrm{e} ^{ \mathrm{j} ω})$体现为连续谱，也就是说，**非周期信号的频谱是连续的**。

式（5-8）的自变量之所以是$\mathrm{e} ^{ \mathrm{j} ω}$，是为了兼容Z变换。

**离散时间傅里叶级数和DTFT的关系**

非周期有限长序列x[n]的傅里叶变换是连续谱，其等间隔采样就是x[n]的周期延拓序列的傅里叶级数的系数。

## 5.3 傅里叶变换的性质

## 5.4 对偶性质

在傅里叶变换和傅里叶级数中，存在着**离散-连续**和**周期-非周期**两大对立。对偶性质将这两大对立联系起来。

一句话总结：**[[#ff0000:时/频域离散↔频/时域周期，时/频域连续↔频/时域非周期#]]**

# 6 离散傅里叶变换

## 6.1 采样定理

前面提到单位冲激函数具有采样性质，那么，可以用一组等间隔的单位冲激组成的“冲激串”p(t)，将其作用于一个连续的信号x(t)，得到对连续信号x(t)的采样。冲激串之间的间隔T称为**采样周期**，其基波频率2π/T称为**采样频率**。

在时域中，作用方式是相乘，那么采样后得到的信号$x_p(t)$为

$$ x_p(t) = x(t) p(t) = \sum _{n = - \infty} ^{ + \infty} x(t) \delta(t - nT) = \sum _{n = - \infty} ^{ + \infty} x(nT) \delta(t - nT) \tag{6-1}$$

TODO

## 6.2 离散傅里叶变换

计算机处理的都是有限长的离散信号，因而研究它们的傅里叶变换和反变换更有实用价值。然而有限长离散信号的DTFT是连续的，这不利于计算机处理，所以引入**离散傅里叶变换（DFT）**，对DTFT的结果作采样，使其变成离散谱。

**① 对连续信号作截断和采样**

现有连续信号x(t)，首先将其截断为有限长信号，使得t限定在[0, L]之间。然后，对其进行采样，将其离散化，得到采样信号$x_p(t)$，采样信号同样是有限长的。设采样周期为T（假设它满足采样定理的要求），采样频率为2π/T，则采样点数N=L/T。根据上一节的讨论，采样信号$x_p(t)$为N个加权冲激的线性组合：

$$ x_p(t) = \sum _{n = 0} ^{N-1} x(nT) \delta(t - nT) \tag{6-2}$$

现在来计算采样信号$x_p(t)$的连续时间傅里叶变换：

$$ X_p(ω) = \sum _{n = 0} ^{N-1} x(nT) \mathrm{e} ^{- \mathrm{j} n T ω} \tag{6-3} $$

这里实际上是通过对连续信号的采样推出了DTFT，式（6-3）在形式上就是有限长离散序列x[n]的DTFT。但它仍然是连续的，因此需要想办法对频域信号作采样，将其变成离散的。

**② 对DTFT的结果作频域采样**

对连续的频域信号作采样，需要选择一个恰当的采样率，使得采样后的信号能够完全重建原来的连续信号。考虑到时域和频域的对偶关系，若时域采样N点满足采样定理的要求，则频域采样N点也可以。因此，取N个频域采样点$ ω_k = (2 \pi / N) k $，则频域采样后的频谱为

$$ X[k] = \sum _{n = 0} ^{N-1} x(nT) \mathrm{e} ^{- \mathrm{j} n T \frac{2 \pi}{N} k} $$

将采样周期T归一化为1，则x(nT)变为离散序列x[n]，此时X[k]可以写成

$$ X[k] = \sum _{n = 0} ^{N-1} x[n] \mathrm{e} ^{- \mathrm{j} n \frac{2 \pi}{N} k} \tag{6-4} $$

式（6-4）即为离散傅里叶变换。其反变换为

$$ x[n] = \frac{1}{N} \sum _{n = 0} ^{N-1} X[k] \mathrm{e} ^{ \mathrm{j} n \frac{2 \pi}{N} k} \tag{6-5} $$

## 6.3 快速傅里叶变换

![蝶形结。图源：维基百科](./image/wiki/M/fft-butterfly.jpg)

# 7 傅里叶变换的应用举例

## 7.1 音视频压缩

## 7.2 大数乘法

## 7.3 天文学

[恒星振动](https://www.zhihu.com/question/23225011/answer/834268222)

## 7.4 光学

[傅里叶光学](https://www.zhihu.com/question/23225011/answer/832462175)

[色散](https://www.zhihu.com/question/23225011/answer/833003906)

## 7.5 通信

## 7.6 量子力学

# 参考文献

+ 奥本海姆. 信号与系统（第二版）[M]
+ 程佩青. 数字信号处理教程[M]
+ 维基百科
